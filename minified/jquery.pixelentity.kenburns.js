(function(g){g.pixelentity=g.pixelentity||{version:"1.0.0"};g.pixelentity.kenburns={conf:{zoom:"random",align:"random",pan:"random",duration:"15"}};var h={width:0,height:0,"margin-left":0,"margin-top":0};var k=["top","center","bottom"];var d=["left","center","right"];var b=false;var i=false;var e=false;var j=false;if(g.browser.msie){b=true;e=g.browser.msie}if(!b&&Modernizr.canvas){i=true}var a=navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad)/);if(a){b=true;i=false}function c(r,n,l,q,p,o,m){if(i){if(n){n.drawImage(r[0],o,m,l*p,q*p)}}else{if(b){if(r){r.transform(p,o,m)}}else{h.width=l*p;h.height=q*p;h["margin-left"]=o;h["margin-top"]=m;if(r){r.css(h)}}}}function f(C,y){var E=this;var D=C;var M,r,z,J,n,K,N,F,G,p,L,A,x,B=500,o=0,v;var l,H,I;function m(){var t;if(o>0){N=F;G=p;n=K}else{t=g.pixelentity.Geom.getScaler(l=="out"?"fill":"none",I.w,I.h,z,J,M,r);N=t.offset.w;G=t.offset.h;n=t.ratio}t=g.pixelentity.Geom.getScaler(l=="in"?"fill":"none",H.w,H.h,z,J,M,r);F=t.offset.w;p=t.offset.h;K=t.ratio;L=0;A=0;B=parseFloat(y.duration)*33;x=0;o++}function q(){return k[parseInt(Math.random()*2+0.5)]+","+d[parseInt(Math.random()*2+0.5)]}function u(){l=y.zoom=="random"?(Math.random()>0.5?"out":"in"):y.zoom;if(a){l="none"}I=g.pixelentity.Geom.splitProps(y.align=="random"?q():y.align);H=g.pixelentity.Geom.splitProps(y.pan=="random"?q():y.pan)}function s(){if(j){return}var t=x/B;var P=n+(K-n)*t;var O=N+(F-N)*t;var w=G+(p-G)*t;c(D,v,M,r,P,O,w);x++;if(x>B){E.stop()}}g.extend(E,{init:function(w){M=C.width()||C[0].width;r=C.height()||C[0].height;var t=C.parent();while(t&&!t.width()){t=t.parent()}z=t?t.width():800;J=t?t.height():600;D.css("image-rendering","optimizeQuality").css("-ms-interpolation-mode","bicubic");if(e){D.parent().css("background-color","black")}E.start()},start:function(){o=0;u();m();if(i){if(!v){v=g('<canvas width="'+z+'" height="'+J+'"></canvas>')[0];D.hide();D.after(v);v=v.getContext("2d");v.fillStyle="rgb(255,255,255)"}}g.pixelentity.ticker.bind("tick",s)},stop:function(){g.pixelentity.ticker.unbind("tick",s)},reset:function(){c(D,v,M,r,ratio,0,0)},pause:function(){j=true},resume:function(){j=false}});if(C.width()==0&&C[0].width==0){C.one("load",E.init)}else{E.init()}}g.fn.kenburns=function(l){var m=this.data("kenburns");if(m){m.start();return m}l=g.extend(true,{},g.pixelentity.kenburns.conf,l);this.each(function(){m=new f(g(this),l);g(this).data("kenburns",m)});return l.api?m:this}})(jQuery);